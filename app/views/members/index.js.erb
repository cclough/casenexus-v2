// Re-renders the user list
$("#map_index_users").html("<%= escape_javascript(render("users")) %>")

// Tooltips on Avatars
$(".application_avatar_icon").tooltip()

// Marker Click Trigger - Has to be in here because other wise does not load in time for list to be loaded
$('.map_index_users_item_button').click(function () {

  var target_id = $(this).attr('data-id');
  var target_lat = $(this).attr('data-lat');
  var target_lng = $(this).attr('data-lng');

  var target_latlng = new google.maps.LatLng(target_lat, target_lng)
  window.map_index_map_pan(target_latlng);
  
  setTimeout((function() {

    return window.map_index_load_infobox(target_id);

  }), 300);

});

// Users Item Cascade Fade
$(".map_index_users_item").each(function (i) {

  if ((i+1) == $(".map_index_users_item").length) {
    $(this).delay((i + 1) * 50).fadeIn(function(){
      $("#map_index_users .application_pagination").fadeIn(500); 
    });
  } else {
    $(this).delay((i + 1) * 50).fadeIn();
  }

});

// Truncate user item names
window.application_truncatables();


$("#map_index_users .application_pagination a").on("click", function() {
  $.getScript(this.href);
  return false;
});




