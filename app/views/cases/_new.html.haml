- provide(:title, 'Give Feedback')
- provide(:sub_title, 'Score and comment on your case partners performance')

- content_for :javascript_includes do
  = javascript_include_tag "cases"

  / - if current_user.help_4_checked
  /   :javascript
  /     $(document).ready(function() {
  /       window.setTimeout("window.application_show_help(4)", 1000);
  /     });

- if @user.blank? then @user = User.find(user_id) end
- if @case.blank? then @case = @user.cases.build end

= form_for @case, remote:true, id: "cases_new_form", url: { controller: :cases, action: :create } do |f|

  = f.hidden_field :user_id, value: @user.id

  = render 'shared/error_messages', object: @case
  .row
    .span.cases_new_expander
      .panel.dark.kill_bottom
        .row
          .span5
            %span.fui-user.application_userimage_medium
          .span#cases_new_target_name
            = link_to "/map?user_id=" + @user.id.to_s,  "data-original-title"=>"Go to #{@user.username}'s profile","data-placement"=>"bottom", class: "application_tooltip" do
              = image_tag @user.university.image_file, class: "application_userimage_small"
              = @user.username





  .row
    #cases_new_book
      - if @book
        .panel.dark.kill_bottom
          = render partial: 'books/show_small', locals: { book_id: @book.id }




  .row#cases_new_nobook
    .panel.darker.kill_bottom
      .row
        .span16#cases_new_nobook_label
          External case details
          %i.icon-caret-right
        .span
          .row
            .span21
              = f.text_field :source, placeholder: "What guide is it from?", tabindex: "2", class: "span20"
            .span20
              = f.text_field :subject, value: params[:subject], placeholder: "What was the case about?", tabindex: "3", id: "cases_new_subject", style: "width:100%;"






  .row#cases_new_guide.panel.darker
    .span11
      %span.cases_new_guide_num 1
      &#61; Low
    .span11
      %span.cases_new_guide_num 2
      &#61; Below Average
    .span11
      %span.cases_new_guide_num 3
      &#61; Average
    .span11
      %span.cases_new_guide_num 4
      &#61; Above Average
    .span11
      %span.cases_new_guide_num 5
      &#61; Exceptional

  .row    
    .span.cases_new_expander
      .cases_new_block_title
        Business Analytics
      .panel.dark.cases_new_block.kill_top

        .row
          .span

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Addition, subtraction, multiplication, division and percentages at back-of-envelope level", "data-original-title" => "Arithmetic" }
                    %i.icon-info-sign.icon-white
                  Quantitative basics
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "quantitativebasics", category: "businessanalytics", existing_score: @case.quantitativebasics }
                .span
                  = f.text_field :quantitativebasics, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_quantitativebasics'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Identifies key issue in case and problem-solving steps needed to solve it", "data-original-title" => "Problem Solution" }
                    %i.icon-info-sign.icon-white
                  Problem-Solving
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "problemsolving", category: "businessanalytics", existing_score: @case.problemsolving }
                .span
                  = f.text_field :problemsolving, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_problemsolving'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Prioritising", "data-original-title" => "Prioritising" }
                    %i.icon-info-sign.icon-white
                  Prioritisation
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "prioritisation", category: "businessanalytics", existing_score: @case.prioritisation }
                .span
                  = f.text_field :prioritisation, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_prioritisation'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Reality Checks Assumptions", "data-original-title" => "Sense-checking" }
                    %i.icon-info-sign.icon-white
                  Sanity-checking
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "sanitychecking", category: "businessanalytics", existing_score: @case.sanitychecking }
                .span
                  = f.text_field :sanitychecking, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_sanitychecking'

          .span1
            .cases_new_block_circle_outer.panel.dark
              .cases_new_block_circle.panel.darker
                #cases_new_block_circle_text_businessanalytics.cases_new_block_circle_text
                      
        .row       
          .cases_new_comment
            .cases_new_comment_content_container
              .cases_new_comment_countChar.application_countChar_count
                hello
              = f.text_area :businessanalytics_comment, placeholder: "Comment...", class: "cases_new_comment_content application_countchar"









  .row    
    .span.cases_new_expander
      .cases_new_block_title
        Structure
      .panel.dark.cases_new_block.kill_top
        
        .row
          .span

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Makes intended approach to problem clear to interviewer up front", "data-original-title" => "Approach up front" }
                    %i.icon-info-sign.icon-white
                  Approach upfront
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "approachupfront", category: "structure", existing_score: @case.approachupfront }
                .span
                  = f.text_field :approachupfront, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_approachupfront'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Sticks to announced structure unless indicates otherwise", "data-original-title" => "Sticks to structure" }
                    %i.icon-info-sign.icon-white
                  Sticking to structure
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "stickingtostructure", category: "structure", existing_score: @case.stickingtostructure }
                .span
                  = f.text_field :stickingtostructure, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_stickingtostructure'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Explicitly announces any deivation from initially announced structure", "data-original-title" => "Announces Deviation" }
                    %i.icon-info-sign.icon-white
                  Announces deviations
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "announceschangedstructure", category: "structure", existing_score: @case.announceschangedstructure }
                .span
                  = f.text_field :announceschangedstructure, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_announceschangedstructure'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Pushes to a conclusion", "data-original-title" => "Push to Ccnclusion" }
                    %i.icon-info-sign.icon-white
                  Pushing to conclusion
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "pushingtoconclusion", category: "structure", existing_score: @case.pushingtoconclusion }
                .span
                  = f.text_field :pushingtoconclusion, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_pushingtoconclusion'

          .span1
            .cases_new_block_circle_outer.panel.dark
              .cases_new_block_circle.panel.darker
                #cases_new_block_circle_text_structure.cases_new_block_circle_text
                  
        .row       
          .cases_new_comment
            .cases_new_comment_content_container
              .cases_new_comment_countChar.application_countChar_count
                hello
              = f.text_area :structure_comment, placeholder: "Comment...", class: "cases_new_comment_content"













  .row    
    .span.cases_new_expander
      .cases_new_block_title
        Interpersonal
      .panel.dark.cases_new_block.kill_top
        
        .row
          .span

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Establishes a rapport with interviewer", "data-original-title" => "Rapport" }
                    %i.icon-info-sign.icon-white
                  Rapport
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "rapport", category: "interpersonal", existing_score: @case.rapport }
                .span
                  = f.text_field :rapport, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_rapport'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Articulates clearly", "data-original-title" => "Articulation" }
                    %i.icon-info-sign.icon-white
                  Articulation
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "articulation", category: "interpersonal", existing_score: @case.articulation }
                .span
                  = f.text_field :articulation, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_articulation'


            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Is Concise", "data-original-title" => "Concise" }
                    %i.icon-info-sign.icon-white
                  Concision
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "concision", category: "interpersonal", existing_score: @case.concision }
                .span
                  = f.text_field :concision, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_concision'

            .cases_new_block_desc.panel.dark
              .row
                .span19
                  .cases_new_criteria_popover.btn{ "rel" => "popover", "data-content" => "Asks for more information when neccessary", "data-original-title" => "Requests Information" }
                    %i.icon-info-sign.icon-white
                  Asks for Information
                .span
                  = render partial: 'cases/scoreselector' , locals: { criteria: "askingforinformation", category: "interpersonal", existing_score: @case.askingforinformation }
                .span
                  = f.text_field :askingforinformation, class: "cases_new_score_input", tabindex: "-1", id: 'cases_new_score_input_askingforinformation'
          .span1
            .cases_new_block_circle_outer.panel.dark
              .cases_new_block_circle.panel.darker
                #cases_new_block_circle_text_interpersonal.cases_new_block_circle_text
                  
        .row       
          .cases_new_comment
            .cases_new_comment_content_container
              .cases_new_comment_countChar.application_countChar_count
                hello
              = f.text_area :interpersonal_comment, placeholder: "Comment...", class: "cases_new_comment_content"



  .row
    .cases_new_block_title
      Top Recommendations for #{@case.user.username}
    #cases_new_recommendations_panel.panel.dark.kill_top
      .row
        = f.text_area :recommendation1, placeholder: "1st Recommendation...", class: "cases_new_recommendation", tabindex: "4"
      .spacer5
      .row
        = f.text_area :recommendation2, placeholder: "2nd Recommendation...", class: "cases_new_recommendation", tabindex: "5"
      .spacer5
      .row
        = f.text_area :recommendation3, placeholder: "3rd Recommendation...", class: "cases_new_recommendation", tabindex: "6"



  .row#cases_new_submit_panel
    = f.submit "Submit Feedback", class: "btn btn-large btn-info", tabindex: "10", id: "cases_new_submit_button"


  / .row#cases_new_submit_panel
  /   #cases_new_submit_button.btn.btn-large.btn-info{tabindex: "10"}
  /     Submit Feedback

  .spacer40
