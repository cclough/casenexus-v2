- provide(:title, 'Your Progress')
- provide(:sub_title, 'Statistics calculated from your feedback from other users')

- content_for :javascript_includes do
  = javascript_include_tag "cases"
  = javascript_include_tag "lib/amcharts"

  :javascript

    var cases_analysis_chart_case_count = #{@case_count_bracket};


  / - if current_user.help_6_checked
  /   :javascript
  /     $(document).ready(function() {
  /       window.setTimeout("window.application_show_help(6)", 1000);
  /     });




.row
  .panel.darker.kill_left.kill_right
    .row
      / .pull-left
      /   = render 'stats'
      .pull-right
        .span7.offset1#cases_analysis_subnav_label
          Views
          %i.icon-caret-right.offset1
        .span44
          .btn-group
            = filterable_analysis("progress", "Over Time")
            = filterable_analysis("table", "Table")
            = filterable_analysis("radar", "Bar & Radar")
            = filterable_analysis("users", "Users")
            = filterable_analysis("comments", "Comments")




.row


  - case @view

  - when "progress"

    - content_for :javascript_includes do

      :javascript

        var cases_analysis_chart_site_average = #{Case.cases_analysis_stats_global("totalscore")};
        var cases_analysis_chart_top_quart = #{Case.cases_analysis_stats_global("totalscore_top_quart")};
        var cases_analysis_chart_bottom_quart = #{Case.cases_analysis_stats_global("totalscore_bottom_quart")};

        $(document).ready(function(){    
          window.cases_analysis_charts_draw(cases_analysis_chart_case_count, cases_analysis_chart_site_average, cases_analysis_chart_top_quart, cases_analysis_chart_bottom_quart);
        });


    #cases_analysis_section_area.cases_analysis_section
      .panel.dark.kill_all
        .row
          .cases_analysis_block_title
            Progress
        .row
          #cases_analysis_chart_progress
            .cases_analysis_loading.progress.progress-striped.active 
              .bar
          #cases_analysis_chart_progress_empty
            #cases_analysis_chart_progress_empty_icon
              %i.icon-bar-chart
            %p You must do at least one case, 
            %p before this chart will work



  - when "table"

    :javascript
      $(document).ready(function(){
        window.cases_analysis_chart_table_bars_draw();
      });


    #cases_analysis_section_table.cases_analysis_section
      .panel.dark.kill_all
        .row
          .cases_analysis_block_title
            Table of Comparisons
        .row
          .btn-group
            .btn.btn-inverse.cases_analysis_section_table_orderby_button{"data-order_by"=>"order"}
              Order
            .btn.btn-inverse.cases_analysis_section_table_orderby_button{"data-order_by"=>"group"}
              Group
          #cases_analysis_section_table_table_container
            = render "analysis_table"



  - when "radar"

    :javascript

      // Radar
      var cases_analysis_chart_radar_data_all = #{Case.cases_analysis_chart_radar_data_all(current_user, @case_count_bracket)};
      var cases_analysis_chart_radar_data_combined = #{Case.cases_analysis_chart_radar_data_combined(current_user, @case_count_bracket)};

      // Bar
      var cases_analysis_chart_bar_data_all = #{Case.cases_analysis_chart_bar_data_all(current_user, @case_count_bracket)};
      var cases_analysis_chart_bar_data_combined = #{Case.cases_analysis_chart_bar_data_combined(current_user, @case_count_bracket)};



      $(document).ready(function(){
        window.cases_analysis_chart_radar_draw("all", cases_analysis_chart_case_count);
        window.cases_analysis_chart_bar_draw("all", cases_analysis_chart_case_count);
      });
      



    #cases_analysis_section_radar.cases_analysis_section

      .row



        .panel.dark.kill_all.span33
          .row
            .cases_analysis_block_title
              Radar
          .row
            #cases_analysis_chart_radar_buttongroup.offset25
              .btn-group
                %a#cases_analysis_chart_radar_button_all.btn.btn-mini.btn-inverse.active All
                %a#cases_analysis_chart_radar_button_combined.btn.btn-mini.btn-inverse Combined
            #cases_analysis_chart_radar
              .cases_analysis_loading.progress.progress-striped.active 
                .bar
            #cases_analysis_chart_radar_empty
              #cases_analysis_chart_radar_empty_icon
                %i.icon-tasks
              %p You must do at least one case, 
              %p before this chart will work



        .panel.dark.kill_right.kill_top.span33
          .row
            .cases_analysis_block_title
              Bar
          .row
            #cases_analysis_chart_bar_buttongroup.offset25
              .btn-group
                %a#cases_analysis_chart_bar_button_all.btn.btn-mini.btn-inverse.active All
                %a#cases_analysis_chart_bar_button_combined.btn.btn-mini.btn-inverse Combined
            #cases_analysis_chart_bar
              .cases_analysis_loading.progress.progress-striped.active 
                .bar
            #cases_analysis_chart_bar_empty
              #cases_analysis_chart_bar_empty_icon
                %i.icon-tasks
              %p You must do at least one case, 
              %p before this chart will work





  - when "users"



    :javascript

      // Country
      var cases_analysis_chart_country_data = #{Case.cases_analysis_chart_country_data(current_user)};

      // University
      var cases_analysis_chart_university_data = #{Case.cases_analysis_chart_university_data(current_user)};


      $(document).ready(function(){
        window.cases_analysis_chart_country_draw();
        window.cases_analysis_chart_university_draw();
      });





    #cases_analysis_section_users.cases_analysis_section
      .panel.dark.kill_all
        .row
          .cases_analysis_block_title
            Country
        .row
          #cases_analysis_chart_country
            .cases_analysis_loading.country.progress-striped.active 
              .bar
          #cases_analysis_chart_country_empty
            #cases_analysis_chart_country_empty_icon
              %i.icon-bar-chart
            %p You must do at least one case, 
            %p before this chart will work



      .panel.dark.kill_left.kill_right.kill_bottom
        .row
          .cases_analysis_block_title
            University
        .row
          #cases_analysis_chart_university
            .cases_analysis_loading.university.progress-striped.active 
              .bar
          #cases_analysis_chart_university_empty
            #cases_analysis_chart_university_empty_icon
              %i.icon-bar-chart
            %p You must do at least one case, 
            %p before this chart will work





  - when "comments"



    #cases_analysis_section_comments.cases_analysis_section
      = render 'comments'
        







